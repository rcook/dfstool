# dfstool

Acorn DFS .ssd File Manager

## Commands

| Command      | Description                                               |
| ------------ | --------------------------------------------------------- |
| `detokenize` | Detokenize BBC BASIC program                              |
| `extract`    | Extract files and metadata from .ssd file                 |
| `make`       | Make .ssd file from files and metadata                    |
| `show`       | Show catalogue                                            |
| `tokenize`   | Tokenize BBC BASIC program                                |
| `help`       | Print this message or the help of the given subcommand(s) |

## Notes

`extract` does not preserve data in sectors that are not referenced by files
present in the catalogue, though it would be straightforward to modify it to
do so. `extract` and `make` do not currently losslessly roundtrip since
`make` stores files in the created .ssd file in alphabetic order by
directory/file name and does not retain the original start sector of each
file. Again, it would be straightforward to change this behaviour. `extract`
and `make` store file metadata in a JSON file which is used to reconstruct
the original DFS catalogue. The metadata tracks the following information:

* DFS directory and file name
* DFS locked attribute
* Load and execution addresses
* Inferred file type

`extract` will also attempt to detokenize any BBC BASIC files it finds along
the way.

By default, `detokenize` will generate "printable" output: i.e. only valid
printable ASCII characters will be present in the output and line endings
will be normalized to Unix-style LF line endings for ease of consumption in
modern text editors etc. "Lossless" mode can be specified with the
`--lossless` option which will retain all non-printable control characters
in the original file as well as using Acorn-style LFCR line endings
(mimicking the output generated by the `*SPOOL` command). Lossless format
can be used to retain the content of obfuscated BBC BASIC programs but must
be carefully edited (most likely as binary files) to retain the control
codes.

## TBD

* Support .dsd files
* Add a "roundtripping" mode (see comments in _Notes_) that would retain the
content of all sectors as well as the original order of catalogue entries
and start sectors

## Licence

[MIT License](LICENSE)
